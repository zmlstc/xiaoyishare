(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-member-set-userpicupload"],{"06ee":function(t,e,o){"use strict";var n=o("ad0f"),i=o.n(n);i.a},"1d04":function(t,e,o){"use strict";var n=o("288e"),i=n(o("5176")),a=n(o("a4bb"));o("ac6a"),o("6c7b");var c=n(o("f499")),r=n(o("c8bb")),u=n(o("a745")),l=n(o("5d73")),s=n(o("85f2")),d=n(o("5d58")),f=n(o("67bb")),h=n(o("d847"));(function(e,o){t.exports=o()})(0,function(){var t=void 0,e=["touchstarted","touchmoved","touchended"];function o(t){return t.charAt(0).toUpperCase()+t.slice(1)}function n(t){for(var o=arguments.length,n=Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];e.forEach(function(e,o){void 0!==n[o]&&(t[e]=n[o])})}function p(t,e){(0,h.default)(t,e)}function g(){return t||(t=wx.getSystemInfoSync()),t}"function"===typeof f.default&&d.default;var v=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},b=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s.default)(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),x=function(){function t(t,e){var o=[],n=!0,i=!1,a=void 0;try{for(var c,r=(0,l.default)(t);!(n=(c=r.next()).done);n=!0)if(o.push(c.value),e&&o.length===e)break}catch(u){i=!0,a=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(i)throw a}}return o}return function(e,o){if((0,u.default)(e))return e;if((0,r.default)(Object(e)))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w={},m={id:{default:"cropper",get:function(){return w.id},set:function(t){w.id=t}},width:{default:750,get:function(){return w.width},set:function(t){w.width=t}},height:{default:750,get:function(){return w.height},set:function(t){w.height=t}},scale:{default:2.5,get:function(){return w.scale},set:function(t){w.scale=t}},zoom:{default:5,get:function(){return w.zoom},set:function(t){w.zoom=t}},src:{default:"cropper",get:function(){return w.src},set:function(t){w.src=t}},cut:{default:{},get:function(){return w.cut},set:function(t){w.cut=t}},onReady:{default:null,get:function(){return w.ready},set:function(t){w.ready=t}},onBeforeImageLoad:{default:null,get:function(){return w.beforeImageLoad},set:function(t){w.beforeImageLoad=t}},onImageLoad:{default:null,get:function(){return w.imageLoad},set:function(t){w.imageLoad=t}},onBeforeDraw:{default:null,get:function(){return w.beforeDraw},set:function(t){w.beforeDraw=t}}};function y(){var t=this,e=g(),o=e.windowWidth;t.attachPage=function(){var e=getCurrentPages(),o=e[e.length-1];o.wecropper=t},t.createCtx=function(){var e=t.id;e&&(t.ctx=wx.createCanvasContext(e))},t.deviceRadio=o/750,t.deviceRadio=t.deviceRadio.toFixed(2)}function k(){var t=this,e=["ready","beforeImageLoad","beforeDraw","imageLoad"];t.on=function(n,i){return e.indexOf(n)>-1&&"function"===typeof i&&("ready"===n?i(t):t["on"+o(n)]=i),t}}function T(){var t=this,e=t.deviceRadio;console.log((0,c.default)(t));var o=t.width,n=t.height,i=t.cut,a=i.x,r=void 0===a?0:a,u=i.y,l=void 0===u?0:u,s=i.width,d=void 0===s?o:s,f=i.height,h=void 0===f?n:f;t.updateCanvas=function(){return t.croperTarget&&t.ctx.drawImage(t.croperTarget,t.imgLeft,t.imgTop,t.scaleWidth,t.scaleHeight),"function"===typeof t.onBeforeDraw&&t.onBeforeDraw(t.ctx,t),t.setBoundStyle(),t.ctx.draw(),t},t.pushOrign=function(e){return t.src=e,"function"===typeof t.onBeforeImageLoad&&t.onBeforeImageLoad(t.ctx,t),uni.getImageInfo({src:e,success:function(o){var n=o.width/o.height;t.croperTarget=o.path||e,n<d/h?(t.rectX=r,t.baseWidth=d,t.baseHeight=d/n,t.rectY=l-Math.abs((h-t.baseHeight)/2)):(t.rectY=l,t.baseWidth=h*n,t.baseHeight=h,t.rectX=r-Math.abs((d-t.baseWidth)/2)),t.imgLeft=t.rectX,t.imgTop=t.rectY,t.scaleWidth=t.baseWidth,t.scaleHeight=t.baseHeight,t.updateCanvas(),"function"===typeof t.onImageLoad&&t.onImageLoad(t.ctx,t)}}),t.update(),t},t.getCropperImage=function(){for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=t.id,c=toString.call(n[0]);switch(c){case"[object Object]":var u=n[0].quality,s=void 0===u?10:u;console.log("quality--"+s),uni.canvasToTempFilePath({canvasId:a,x:r,y:l,width:d,height:h,destWidth:d*s/(10*e),destHeight:h*s/(10*e),success:function(t){console.log(t),"function"===typeof n[n.length-1]&&n[n.length-1](t.tempFilePath)}});break;case"[object Function]":uni.canvasToTempFilePath({canvasId:a,x:r,y:l,fileType:"jpg",width:d,height:h,destWidth:d,destHeight:h,success:function(t){"function"===typeof n[n.length-1]&&n[n.length-1](t.tempFilePath)}});break}return t}}function S(){var t=this;t.src&&(t.__oneTouchStart=function(e){t.touchX0=e.x,t.touchY0=e.y},t.__oneTouchMove=function(e){var o=void 0,n=void 0;if(t.touchended)return t.updateCanvas();o=e.x-t.touchX0,n=e.y-t.touchY0;var i=t.rectX+o,a=t.rectY+n;t.outsideBound(i,a),t.updateCanvas()},t.__twoTouchStart=function(e,o){var n=void 0,i=void 0,a=void 0;t.touchX1=t.rectX+t.scaleWidth/2,t.touchY1=t.rectY+t.scaleHeight/2,n=o.x-e.x,i=o.y-e.y,a=Math.sqrt(n*n+i*i),t.oldDistance=a},t.__twoTouchMove=function(e,o){var n=void 0,i=void 0,a=void 0,c=t.scale,r=t.zoom;n=o.x-e.x,i=o.y-e.y,a=Math.sqrt(n*n+i*i),t.newScale=t.oldScale+.001*r*(a-t.oldDistance),t.newScale<=1&&(t.newScale=1),t.newScale>=c&&(t.newScale=c),t.scaleWidth=t.newScale*t.baseWidth,t.scaleHeight=t.newScale*t.baseHeight;var u=t.touchX1-t.scaleWidth/2,l=t.touchY1-t.scaleHeight/2;t.outsideBound(u,l),t.updateCanvas()},t.__xtouchEnd=function(){t.oldScale=t.newScale,t.rectX=t.imgLeft,t.rectY=t.imgTop})}var C={touchStart:function(t){var e=this,o=x(t.touches,2),i=o[0],a=o[1];console.log((0,c.default)(a)),i.x||(i.x=i.clientX,i.y=i.clientY,a&&(a.x=a.clientX,a.y=a.clientY)),n(e,!0,null,null),e.__oneTouchStart(i),t.touches.length>=2&&e.__twoTouchStart(i,a)},touchMove:function(t){var e=this,o=x(t.touches,2),i=o[0],a=o[1];i.x||(i.x=i.clientX,i.y=i.clientY,a&&(a.x=a.clientX,a.y=a.clientY)),n(e,null,!0),1===t.touches.length&&e.__oneTouchMove(i),t.touches.length>=2&&e.__twoTouchMove(i,a)},touchEnd:function(t){var e=this;n(e,!1,!1,!0),e.__xtouchEnd()}};function L(){var t=this,e=(t.deviceRadio,t.width),o=t.height,n=t.cut,i=n.x,a=void 0===i?0:i,c=n.y,r=void 0===c?0:c,u=n.width,l=void 0===u?e:u,s=n.height,d=void 0===s?o:s;t.outsideBound=function(e,o){t.imgLeft=e>=a?a:t.scaleWidth+e-a<=l?a+l-t.scaleWidth:e,t.imgTop=o>=r?r:t.scaleHeight+o-r<=d?r+d-t.scaleHeight:o},t.setBoundStyle=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.color,c=void 0===i?"#04b00f":i,u=n.mask,s=void 0===u?"rgba(0, 0, 0, 0.3)":u,f=n.lineWidth,h=void 0===f?1:f;t.ctx.beginPath(),t.ctx.setFillStyle(s),t.ctx.fillRect(0,0,a,o),t.ctx.fillRect(a,0,l,r),t.ctx.fillRect(a,r+d,l,o-r-d),t.ctx.fillRect(a+l,0,e-a-l,o),t.ctx.fill(),t.ctx.beginPath(),t.ctx.setStrokeStyle(c),t.ctx.setLineWidth(h),t.ctx.moveTo(a-h,r+10-h),t.ctx.lineTo(a-h,r-h),t.ctx.lineTo(a+10-h,r-h),t.ctx.stroke(),t.ctx.beginPath(),t.ctx.setStrokeStyle(c),t.ctx.setLineWidth(h),t.ctx.moveTo(a-h,r+d-10+h),t.ctx.lineTo(a-h,r+d+h),t.ctx.lineTo(a+10-h,r+d+h),t.ctx.stroke(),t.ctx.beginPath(),t.ctx.setStrokeStyle(c),t.ctx.setLineWidth(h),t.ctx.moveTo(a+l-10+h,r-h),t.ctx.lineTo(a+l+h,r-h),t.ctx.lineTo(a+l+h,r+10-h),t.ctx.stroke(),t.ctx.beginPath(),t.ctx.setStrokeStyle(c),t.ctx.setLineWidth(h),t.ctx.moveTo(a+l+h,r+d-10+h),t.ctx.lineTo(a+l+h,r+d+h),t.ctx.lineTo(a+l-10+h,r+d+h),t.ctx.stroke()}}var I="1.1.4",_=function(){function t(e){v(this,t);var o=this,n={};return p(o,m),(0,a.default)(m).forEach(function(t){n[t]=m[t].default}),(0,i.default)(o,n,e),o.prepare(),o.attachPage(),o.createCtx(),o.observer(),o.cutt(),o.methods(),o.init(),o.update(),o}return b(t,[{key:"init",value:function(){var t=this,e=t.src;return t.version=I,"function"===typeof t.onReady&&t.onReady(t.ctx,t),e&&t.pushOrign(e),n(t,!1,!1,!1),t.oldScale=1,t.newScale=1,t}}]),t}();return(0,i.default)(_.prototype,C),_.prototype.prepare=y,_.prototype.observer=k,_.prototype.methods=T,_.prototype.cutt=L,_.prototype.update=S,_})},"414d":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"m-mian"},[o("v-uni-view",{staticClass:"cropper-wrapper",staticStyle:{height:"617px"}},[o("v-uni-canvas",{staticClass:"cropper",style:{width:t.cropperOpt.width,height:t.cropperOpt.height},attrs:{"disable-scroll":"true","canvas-id":"cropper"},on:{touchstart:function(e){e=t.$handleEvent(e),t.touchStart(e)},touchmove:function(e){e=t.$handleEvent(e),t.touchMove(e)},touchend:function(e){e=t.$handleEvent(e),t.touchEnd(e)}}})],1),o("v-uni-view",{staticClass:"cropper-buttons"},[o("v-uni-view",{staticClass:"upload",on:{click:function(e){e=t.$handleEvent(e),t.uploadTap(e)}}},[t._v("重新选择")]),o("v-uni-view",{staticClass:"getCropperImage",on:{click:function(e){e=t.$handleEvent(e),t.getCropperImage(e)}}},[t._v("确定")])],1)],1)},i=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return i})},"5bba":function(t,e,o){o("9d98");var n=o("584a").Object;t.exports=function(t,e){return n.defineProperties(t,e)}},"6c7b":function(t,e,o){var n=o("5ca1");n(n.P,"Array",{fill:o("36bd")}),o("9c6c")("fill")},"9d98":function(t,e,o){var n=o("63b6");n(n.S+n.F*!o("8e60"),"Object",{defineProperties:o("7e90")})},a6b7:function(t,e,o){"use strict";o.r(e);var n=o("414d"),i=o("bb7a");for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);o("06ee");var c=o("2877"),r=Object(c["a"])(i["default"],n["a"],n["b"],!1,null,"1b19f34a",null);e["default"]=r.exports},ad0f:function(t,e,o){var n=o("af0c");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=o("4f06").default;i("534bfaf6",n,!0,{sourceMap:!1,shadowMode:!1})},af0c:function(t,e,o){e=t.exports=o("2350")(!1),e.push([t.i,".content[data-v-1b19f34a]{background:#fff}.head-list[data-v-1b19f34a]{height:43px;width:100%;background:#fff;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom:1px solid #f4f4f4}.head-info[data-v-1b19f34a]{text-align:center;font-size:18px;color:#000;font-weight:700}.save-box[data-v-1b19f34a]{position:absolute;right:0;width:50px;height:43px;line-height:43px}.save[data-v-1b19f34a]{color:#626ffc;font-size:16px;font-weight:400}.icon-back[data-v-1b19f34a]{margin-top:11px;width:10px;height:18px;color:#000;margin-left:6px}.icon-back-box[data-v-1b19f34a]{display:block;position:absolute;left:6px;height:43px;width:30px;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.cropper[data-v-1b19f34a]{position:absolute;top:0;left:0;width:100%;height:100%}.cropper-buttons[data-v-1b19f34a]{background-color:rgba(0,0,0,.95);color:#04b00f}.cropper-wrapper[data-v-1b19f34a]{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;width:100%;background-color:#f0f0f0}.cropper-buttons[data-v-1b19f34a]{width:100vw;height:50px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;position:fixed;bottom:0;left:0;line-height:50px}.cropper-buttons .getCropperImage[data-v-1b19f34a],.cropper-buttons .upload[data-v-1b19f34a]{width:50%;text-align:center}",""])},bb7a:function(t,e,o){"use strict";o.r(e);var n=o("c0f1"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);e["default"]=i.a},c0f1:function(t,e,o){"use strict";var n=o("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(o("5176"));o("34ef"),o("28a5");var a=n(o("cebc")),c=n(o("1d04")),r=o("2f62"),u=uni.getSystemInfoSync(),l=u.windowWidth,s=u.windowHeight-50;console.log(u);var d={data:function(){return{cropperOpt:{id:"cropper",width:l,height:s,scale:2.5,zoom:8,cut:{x:(l-295)/2,y:(s-413)/2,width:295,height:295}},weCropper:""}},computed:(0,r.mapState)(["hasLogin","userInfo"]),methods:(0,a.default)({},(0,r.mapMutations)(["setUserInfo"]),{touchStart:function(t){this.weCropper.touchStart(t)},touchMove:function(t){this.weCropper.touchMove(t)},touchEnd:function(t){this.weCropper.touchEnd(t)},convertBase64UrlToBlob:function(t,e){for(var o=atob(t.split(",")[1]),n=[],i=0;i<o.length;i++)n.push(o.charCodeAt(i));return new Blob([new Uint8Array(n)],{type:e},{filename:"1111.jpg"})},blobToDataURL:function(t){var e=new FileReader;e.readAsDataURL(t),e.onload=function(t){var e=t.target.result;console.log(e)}},getCropperImage:function(){var t=this;uni.showLoading({title:"图片处理中..."}),t.weCropper.getCropperImage(function(e){e?t.$Request.upLoadFile("member_account/ajax_update_avatar",e).then(function(e){if(console.log(e),console.log("===upload======"),200==e.code){console.log("===upload=2====="),uni.hideLoading(),console.log(e);var o=t.userInfo;o.avatar=e.datas.avatar+"&rd="+Math.random(),t.setUserInfo(o),uni.showToast({icon:"none",title:e.datas.info,duration:3e3}),wx.redirectTo({url:"userset"})}else uni.showToast({icon:"none",title:e.datas.error,duration:2e3}),uni.hideLoading()}):console.log("获取图片失败，请稍后重试")})},uploadTap:function(){var t=this;uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var o=e.tempFilePaths[0];t.weCropper.pushOrign(o)}})}}),onLoad:function(t){this.hasLogin||uni.navigateTo({url:"../login"});var e=this.cropperOpt,o=t.src;o&&((0,i.default)(e,{src:o}),this.weCropper=new c.default(e).on("ready",function(t){}).on("beforeImageLoad",function(t){uni.showToast({title:"上传中",icon:"loading",duration:3e3})}).on("imageLoad",function(t){uni.hideToast()}))}};e.default=d},d847:function(t,e,o){t.exports=o("5bba")}}]);